---
name: shop-exchange-analysis
description: å…‘æ¢å•†åº—æ•°æ®æ·±åº¦åˆ†æï¼ˆNotion + Wiki åŒç‰ˆæœ¬ï¼‰ã€‚äº”ç»´åˆ†æ + 5 å¼ å›¾è¡¨ + è¿è¥ä¼˜åŒ–å»ºè®®ã€‚æ”¯æŒè‡ªåŠ¨é“å…·åˆ†ç±»ã€é¥±å’Œåº¦è¯„ä¼°ã€ä»£å¸æ¶ˆè€—ç»“æ„æ‹†è§£ã€å››è±¡é™å®šä½ã€‚
---

# å…‘æ¢å•†åº—æ•°æ®æ·±åº¦åˆ†æï¼ˆNotion + Wiki åŒç‰ˆæœ¬ï¼‰

## When to Use This Skill

å½“ç”¨æˆ·éœ€è¦ï¼š

- åˆ†ææ¸¸æˆå†…å…‘æ¢å•†åº—çš„é“å…·æ•°æ®
- è¯„ä¼°å…‘æ¢é¥±å’Œåº¦ã€ä»£å¸æ¶ˆè€—ã€å•†å“ç»“æ„
- ç”¨æˆ·æåˆ°"å…‘æ¢å•†åº—"ã€"å•†åº—åˆ†æ"ã€"å…‘æ¢æ•°æ®"ã€"shop exchange"ã€"å…‘æ¢é¥±å’Œåº¦"ã€"ä»£å¸æ¶ˆè€—"æ—¶
- å…¶ä»–å¤ç›˜ Skillï¼ˆå¦‚ event-review-singleï¼‰ä¸­æ¶‰åŠå…‘æ¢å•†åº—å­æ¨¡å—æ—¶

## è¾“å…¥æ•°æ®

### å¿…å¡«å­—æ®µ

æ¯æ¡é“å…·æ•°æ®éœ€åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µ | ä¸­æ–‡ | ç±»å‹ | è¯´æ˜ |
|------|------|------|------|
| item_name | é“å…·åç§° | string | é“å…·å…¨ç§° |
| exchange_users | å…‘æ¢äººæ¬¡ | int | å…‘æ¢è¯¥é“å…·çš„æ€»äººæ¬¡ |
| exchange_count | å…‘æ¢æ¬¡æ•° | int | å…‘æ¢è¯¥é“å…·çš„æ€»æ¬¡æ•° |
| avg_exchanges_per_user | äººå‡å…‘æ¢æ¬¡æ•° | float | = exchange_count / exchange_users |
| avg_token_cost | å¹³å‡æ¶ˆè€—ä»£å¸ | float | äººå‡ä»£å¸æ¶ˆè€— |
| token_price | ä»£å¸ä»·æ ¼ | int | å•æ¬¡å…‘æ¢çš„ä»£å¸å•ä»· |
| purchase_limit | é™è´­æ•°é‡ | int | æ¯äººé™è´­ä¸Šé™ |
| saturation_rate | å…‘æ¢é¥±å’Œåº¦ | float | = avg_exchanges_per_user / purchase_limit Ã— 100% |

### å¯é€‰å­—æ®µ

| å­—æ®µ | ä¸­æ–‡ | ç±»å‹ | è¯´æ˜ |
|------|------|------|------|
| activity_name | æ´»åŠ¨åç§° | string | æ‰€å±æ´»åŠ¨ï¼ˆç”¨äºæŠ¥å‘Šæ ‡é¢˜ï¼‰ |
| shop_name | å•†åº—åç§° | string | å•†åº—åç§°ï¼ˆå¦‚æœ‰å¤šä¸ªå•†åº—ï¼‰ |
| category | é“å…·ç±»åˆ« | string | æ‰‹åŠ¨æŒ‡å®šåˆ†ç±»ï¼ˆç•™ç©ºåˆ™è‡ªåŠ¨åˆ†ç±»ï¼‰ |

## æ•°æ®è¾“å…¥æ–¹å¼

æ ¹æ®ç”¨æˆ·æ„å›¾é€‰æ‹©è¾“å…¥é€”å¾„ï¼š

### é€”å¾„ A: æ–‡æœ¬ç²˜è´´ï¼ˆæœ€å¸¸ç”¨ï¼‰

ç”¨æˆ·ç›´æ¥ç²˜è´´ Tab åˆ†éš”æˆ–è¡¨æ ¼æ ¼å¼çš„æ•°æ®ã€‚Agent è§£æåè½¬ä¸ºæ ‡å‡† JSONã€‚

**è§£æè§„åˆ™ï¼š**
1. è‡ªåŠ¨è¯†åˆ«è¡¨å¤´è¡Œï¼ˆåŒ…å«"é“å…·åç§°"æˆ–"item_name"ï¼‰
2. æŒ‰ Tab / ç©ºæ ¼ / | åˆ†éš”ç¬¦åˆ‡åˆ†
3. æ•°å€¼åˆ—è‡ªåŠ¨å»é™¤ % ç¬¦å·å¹¶è½¬ float
4. é‡å¤é“å…·åç§°è‡ªåŠ¨æ·»åŠ åºå·åç¼€ï¼ˆå¦‚ â‘¡â‘¢ï¼‰

### é€”å¾„ B: JSON ç›´æ¥è¾“å…¥

ç”¨æˆ·æä¾›ç¬¦åˆ `schema/input_schema.json` çš„ JSON æ•°æ®ã€‚

### é€”å¾„ C: Excel æ–‡ä»¶

1. ç”Ÿæˆæ¨¡æ¿ï¼š

```python
import sys
sys.path.insert(0, 'skills/shop_exchange_analysis/scripts')
from data_parser import generate_excel_template

generate_excel_template('report_images/<activity_name>/shop_template.xlsx')
```

2. ç­‰å¾…ç”¨æˆ·å¡«å†™
3. è§£æ Excelï¼š

```python
from data_parser import parse_excel
data = parse_excel('<Excelæ–‡ä»¶è·¯å¾„>')
```

## æ‰§è¡Œæµç¨‹

ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹ 5 ä¸ªæ­¥éª¤é¡ºåºæ‰§è¡Œã€‚**ä¸è¦è·³è¿‡ä»»ä½•æ­¥éª¤ã€‚**

---

### Step 1: æ•°æ®æ”¶é›†ä¸è§£æ

1. æ ¹æ®ç”¨æˆ·è¾“å…¥æ–¹å¼ï¼Œè°ƒç”¨å¯¹åº”çš„è§£æå‡½æ•°
2. è‡ªåŠ¨è¿›è¡Œé“å…·åˆ†ç±»ï¼ˆè¯¦è§åˆ†ç±»è§„åˆ™ï¼‰
3. è®¡ç®—è¡ç”ŸæŒ‡æ ‡ï¼ˆæ€»ä»£å¸æ¶ˆè€— = å…‘æ¢æ¬¡æ•° Ã— ä»£å¸ä»·æ ¼ï¼‰
4. æ•°æ®æ ¡éªŒï¼šæ£€æŸ¥å¿…å¡«å­—æ®µã€æ•°å€¼åˆæ³•æ€§

```python
import sys, json
sys.path.insert(0, 'skills/shop_exchange_analysis/scripts')
from data_parser import parse_text_input, auto_categorize

items = parse_text_input(raw_text)  # æˆ– parse_excel / parse_json
items = auto_categorize(items)
```

**é“å…·è‡ªåŠ¨åˆ†ç±»è§„åˆ™ï¼š**

| ç±»åˆ« | å…³é”®è¯åŒ¹é… |
|------|-----------|
| ä¸»åŸçš®è‚¤ | çš®è‚¤ |
| è‹±é›„å…»æˆ | è‹±é›„, å‡æ˜Ÿ, ç¢ç‰‡ |
| å†›å¤‡å…»æˆ | å†›å¤‡, T6 |
| è£…å¤‡å…»æˆ | è£…å¤‡, çº³ç±³, æ™¶ä½“, é‡é“¸ |
| åŠ é€Ÿé“å…· | åŠ é€Ÿ |
| æ”¶è—å“ | æ”¶è—å“ |
| æ ¸å¿ƒææ–™ | æœºèƒ½æ ¸å¿ƒ |
| èµ„æº/æŠ½å¥– | èµ„æº, å¥–æ± , å®ç®± |

> Agent å¯æ ¹æ®å®é™…æ¸¸æˆç‰ˆæœ¬æ‰©å±•åˆ†ç±»è§„åˆ™ã€‚è‹¥é‡åˆ°æ— æ³•è‡ªåŠ¨åˆ†ç±»çš„é“å…·ï¼Œå‘ç”¨æˆ·ç¡®è®¤ã€‚

---

### Step 2: åˆ†æå¼•æ“

è°ƒç”¨åˆ†ææ¨¡å—ï¼Œç”Ÿæˆäº”ç»´åˆ†æç»“è®ºï¼š

```python
from analyzer import ShopExchangeAnalyzer

analyzer = ShopExchangeAnalyzer(items)
results = analyzer.run_all()
```

#### 2.1 äº”å¤§åˆ†æç»´åº¦

| # | ç»´åº¦ | åˆ†æå†…å®¹ | è¾“å‡º |
|---|------|---------|------|
| 1 | é¥±å’Œåº¦åˆ†æ | æ’åã€é«˜/ä½é¥±å’Œåº¦åˆ†ç»„ã€ä¾›éœ€å¤±è¡¡æ£€æµ‹ | é«˜éœ€æ±‚/ä¾›è¿‡äºæ±‚é“å…·æ¸…å• |
| 2 | æ¶ˆè€—ç»“æ„åˆ†æ | å„ç±»åˆ«ä»£å¸æ¶ˆè€—å æ¯”ã€æ¶ˆè€—é›†ä¸­åº¦ | ç±»åˆ«å æ¯”è¡¨ + æ ¸å¿ƒå‘ç° |
| 3 | äººæ¬¡-æ¶ˆè€—äº¤å‰åˆ†æ | è¦†ç›–å¹¿åº¦ vs æ¶ˆè€—æ·±åº¦ | è±¡é™åˆ†å¸ƒ |
| 4 | å››è±¡é™å®šä½ | äººå‡æ¶ˆè€— Ã— é¥±å’Œåº¦ å››è±¡é™ | é“å…·å®šä½çŸ©é˜µ |
| 5 | çš®è‚¤ä¸“é¡¹åˆ†æ | é«˜ä»·é™é‡é“å…·ä¸“é¡¹ï¼ˆå¦‚æœ‰ï¼‰ | çš®è‚¤å…‘æ¢æƒ…å†µ |

#### 2.2 åˆ†æé˜ˆå€¼é…ç½®

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| HIGH_SATURATION_THRESHOLD | 10% | é«˜é¥±å’Œåº¦åˆ†ç•Œçº¿ |
| MED_SATURATION_THRESHOLD | 5% | ä¸­é¥±å’Œåº¦åˆ†ç•Œçº¿ |
| LOW_SATURATION_THRESHOLD | 1% | ä½é¥±å’Œåº¦åˆ†ç•Œçº¿ |
| SKIN_PRICE_THRESHOLD | 50000 | çš®è‚¤ç±»é«˜ä»·é“å…·åˆ†ç•Œçº¿ |

> Agent å¯æ ¹æ®å®é™…æ•°æ®åˆ†å¸ƒåŠ¨æ€è°ƒæ•´é˜ˆå€¼ã€‚

---

### Step 3: å›¾è¡¨ç”Ÿæˆ

```python
from chart_generator import ShopChartGenerator

chart_gen = ShopChartGenerator(items, results, output_dir)
chart_gen.generate_all()
```

#### 5 å¼ å›¾è¡¨

| # | å›¾è¡¨ | æ–‡ä»¶å | è¯´æ˜ |
|---|------|--------|------|
| 1 | å…‘æ¢é¥±å’Œåº¦æ’å | chart1_saturation.png | æ°´å¹³æ¡å½¢å›¾ + é˜ˆå€¼çº¿ + åˆ†ç±»ç€è‰² |
| 2 | äººæ¬¡vsæ¶ˆè€—æ°”æ³¡å›¾ | chart2_bubble.png | åŒå¯¹æ•°è½´ + åˆ†ç±»æ°”æ³¡ |
| 3 | åˆ†ç±»æ¶ˆè´¹ç»“æ„ | chart3_category_pie.png | åŒé¥¼å›¾ï¼ˆæ¶ˆè€—å æ¯” + äººæ¬¡å æ¯”ï¼‰ |
| 4 | å››è±¡é™å®šä½ | chart4_quadrant.png | æ•£ç‚¹å›¾ + ä¸­ä½æ•°åˆ†å‰² + è±¡é™æ ‡æ³¨ |
| 5 | çš®è‚¤/é«˜ä»·é“å…·ä¸“é¡¹ | chart5_special.png | æ¡å½¢å›¾ï¼ˆä»…æœ‰é«˜ä»·é“å…·æ—¶ç”Ÿæˆï¼‰ |

å›¾è¡¨é£æ ¼ï¼š
- DPI: 150
- ä¸­æ–‡å­—ä½“: SimHei / Microsoft YaHei
- é¢œè‰²æ–¹æ¡ˆ: æŒ‰ç±»åˆ«ç»Ÿä¸€é…è‰²
- å»é™¤é¡¶éƒ¨/å³ä¾§è¾¹æ¡†

---

### Step 4: æŠ¥å‘Šç”Ÿæˆ + å‘å¸ƒ

#### 4.1 Notion ç‰ˆæœ¬

```python
from report_generator import ShopReportGenerator

report_gen = ShopReportGenerator(items, results, chart_dir, activity_name)
notion_content = report_gen.generate_notion()
notion_title = report_gen.generate_title()
```

ä½¿ç”¨ Notion MCP `create-pages` å‘å¸ƒï¼š

```
å·¥å…·: Notion MCP create-pages
å‚æ•°:
  pages: [{
    "properties": {"title": "<notion_title>"},
    "content": "<notion_content>"
  }]
```

**Notion æ ¼å¼è§„åˆ™ï¼š**
- Executive Summary ç”¨ `<callout icon="ğŸª" color="blue_bg">` åŒ…è£¹
- æ­£å‘æŒ‡æ ‡ç”¨ `<span color="green">`ï¼Œè´Ÿå‘ç”¨ `<span color="red">`
- è¡¨æ ¼ç”¨ `<table><tr><td>` æ ¼å¼
- å»ºè®®ç”¨ `<span color="red">` æ ‡æ³¨é«˜ä¼˜å…ˆçº§ï¼Œ`<span color="orange">` æ ‡æ³¨ä¸­ä¼˜å…ˆçº§

#### 4.2 Wiki ç‰ˆæœ¬

**ç›´æ¥åœ¨èŠå¤©æ¡†ä¸­è¾“å‡ºå®Œæ•´æŠ¥å‘Šå†…å®¹**ï¼Œç”¨æˆ·å¤åˆ¶ç²˜è´´åˆ° Wiki ç¼–è¾‘å™¨ã€‚

**Wiki æ ¼å¼è§„åˆ™ï¼š**
- ä¸ç”¨ `**ç²—ä½“**`ã€HTMLã€Emoji
- ç”¨ã€ã€‘å¼ºè°ƒå…³é”®æ•°å­—
- è¡¨æ ¼ç”¨ç®¡é“è¯­æ³• `| col | col |`

#### 4.3 æœ¬åœ° Markdown ç‰ˆæœ¬

åŒæ—¶ä¿å­˜ä¸€ä»½åˆ° `report_images/<activity_name>/å•†åº—å…‘æ¢æ•°æ®åˆ†ææŠ¥å‘Š.md`

---

### Step 5: äº¤ä»˜ç¡®è®¤

äº¤ä»˜ç‰©æ¸…å•ï¼š

1. **5 å¼ å›¾è¡¨** - ä¿å­˜åœ¨ `report_images/{activity_name}/` ç›®å½•
2. **Notion é¡µé¢** - å·²å‘å¸ƒï¼Œè¿”å›é¡µé¢ URL
3. **Wiki æŠ¥å‘Š** - èŠå¤©æ¡†ç›´æ¥è¾“å‡ºï¼ˆç”¨æˆ·è¦æ±‚æ—¶ï¼‰
4. **æœ¬åœ° Markdown** - ä¿å­˜åœ¨å›¾è¡¨åŒç›®å½•

---

## æŠ¥å‘Šç»“æ„ï¼ˆåŒç‰ˆæœ¬å…±ç”¨ï¼‰

1. **Executive Summary** â€” 4 æ¡æ ¸å¿ƒå‘ç°æ‘˜è¦
2. **ä¸€ã€æ•°æ®æ€»è§ˆ** â€” å…³é”®æŒ‡æ ‡æ±‡æ€»è¡¨
3. **äºŒã€å…‘æ¢é¥±å’Œåº¦åˆ†æ** â€” é«˜/ä½é¥±å’Œåº¦åˆ†ç»„ + å›¾è¡¨
4. **ä¸‰ã€ä»£å¸æ¶ˆè€—ç»“æ„åˆ†æ** â€” ç±»åˆ«å æ¯” + å›¾è¡¨
5. **å››ã€å…‘æ¢äººæ¬¡ vs ä»£å¸æ¶ˆè€—** â€” è±¡é™è§£è¯» + å›¾è¡¨
6. **äº”ã€å››è±¡é™å®šä½åˆ†æ** â€” å®šä½çŸ©é˜µ + å›¾è¡¨
7. **å…­ã€é«˜ä»·é“å…·/çš®è‚¤ä¸“é¡¹**ï¼ˆå¦‚æœ‰ï¼‰â€” ä¸“é¡¹åˆ†æ + å›¾è¡¨
8. **ä¸ƒã€è¿è¥ä¼˜åŒ–å»ºè®®** â€” P1/P2/P3 åˆ†çº§å»ºè®®
   - P1: é™è´­è°ƒæ•´å»ºè®®
   - P2: å®šä»·ç­–ç•¥å»ºè®®
   - P3: å•†å“ç»“æ„å»ºè®®

---

## ä¸å…¶ä»– Skill çš„é›†æˆ

æœ¬ Skill å¯è¢«å…¶ä»–å¤ç›˜ Skill ä½œä¸ºå­æ¨¡å—è°ƒç”¨ï¼š

```python
# åœ¨ event-review-single æˆ–å…¶ä»– Skill ä¸­
import sys
sys.path.insert(0, 'skills/shop_exchange_analysis/scripts')
from main import run_shop_analysis

# ä¼ å…¥æ ‡å‡†åŒ–æ•°æ®
result = run_shop_analysis(
    items=items_list,          # List[dict] é“å…·æ•°æ®
    activity_name='æ¨å¸æœº',     # æ´»åŠ¨åç§°
    output_dir='report_images/æ¨å¸æœº/',  # è¾“å‡ºç›®å½•
    output_format='both'       # 'notion' / 'wiki' / 'both'
)

# è¿”å›
# result['charts']         â†’ å›¾è¡¨æ–‡ä»¶è·¯å¾„åˆ—è¡¨
# result['analysis']       â†’ åˆ†æç»“è®º dict
# result['notion_content'] â†’ Notion æ ¼å¼æŠ¥å‘Šå†…å®¹
# result['wiki_content']   â†’ Wiki æ ¼å¼æŠ¥å‘Šå†…å®¹
# result['markdown']       â†’ æœ¬åœ° Markdown å†…å®¹
```

---

## ä¾èµ–

- Python 3.9+
- matplotlib>=3.7.0, numpy>=1.24.0, pandas>=2.0.0, openpyxl>=3.1.0

```bash
pip install matplotlib numpy pandas openpyxl
```

## é”™è¯¯å¤„ç†

- ç¼ºå°‘ä¾èµ– â†’ è‡ªåŠ¨å®‰è£…
- æ•°æ®è§£æå¤±è´¥ â†’ æç¤ºç”¨æˆ·æ£€æŸ¥æ ¼å¼ï¼Œç»™å‡ºé¢„æœŸæ ¼å¼ç¤ºä¾‹
- å›¾è¡¨ç”Ÿæˆå¤±è´¥ â†’ æ£€æŸ¥ matplotlib ä¸­æ–‡å­—ä½“ï¼Œå°è¯• fallback å­—ä½“
- Notion å‘å¸ƒå¤±è´¥ â†’ é‡è¯•æˆ–æ”¹ä¸ºè¾“å‡º Markdown æ–‡æœ¬
- é“å…·æ— æ³•è‡ªåŠ¨åˆ†ç±» â†’ å‘ç”¨æˆ·ç¡®è®¤åˆ†ç±»
